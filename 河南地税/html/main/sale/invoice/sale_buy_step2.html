<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<title>买房信息</title>
		<link href="../../../../css/Hui.css" rel="stylesheet" type="text/css" />
		<style type="text/css">
			.H_header_bg {
				background: #09a4de
			}
		</style>
	</head>
	<body>
		<div class="H-padding-vertical-bottom-10"></div>
		<div class="H-channel-title H-flexbox-horizontal H-theme-background-color-white H-vertical-middle H-border-vertical-bottom-after">
			<div class="H-channel-line H-theme-background-color-black H-padding-vertical-top-15 H-padding-horizontal-left-3  H-margin-horizontal-left-10"></div>
			<div class="H-channel-text H-theme-font-color-black H-flex-item H-font-size-18 H-theme-font-color-black H-padding-10 H-margin-horizontal-right-10 H-text-show-row-1">
				买方信息
			</div>
		</div>
		<form id="forms">
			<div class="H-border-vertical-both-after" id="sale_html">
				<div class="H-flexbox-horizontal H-border-vertical-bottom-margin-left-10-after">
					<span class="H-vertical-middle H-padding-horizontal-left-10 H-theme-background-color-white H-font-size-14">纳税人识别号：</span>
					<input type="text" name="gmfnsrsbh" value="1212002" class="H-textbox H-vertical-align-middle H-vertical-middle H-font-size-14 H-flex-item H-box-sizing-border-box H-border-none H-outline-none H-padding-12" data-rule="n" data-nullmsg="纳税人识别号不能为空" data-errmsg="纳税人识别号格式错误"
					placeholder="填写纳税人识别号" />
				</div>
				<div class="H-flexbox-horizontal H-border-vertical-bottom-margin-left-10-after">
					<span class="H-vertical-middle H-padding-horizontal-left-10 H-theme-background-color-white H-font-size-14">纳税人名称：</span>
					<input type="text" name="gmfmc" value="陈陈" class="H-textbox H-vertical-align-middle H-vertical-middle H-font-size-14 H-flex-item H-box-sizing-border-box H-border-none H-outline-none H-padding-12" data-rule="s" data-nullmsg="纳税人名称不能为空" data-errmsg="纳税人名称填写错误"
					placeholder="填写纳税人名称" />
				</div>
				<div class="H-flexbox-horizontal H-border-vertical-bottom-margin-left-10-after">
					<span class="H-vertical-middle H-padding-horizontal-left-10 H-theme-background-color-white H-font-size-14">国籍代码：</span>
					<input type="text" name="gmfgj_dm" value="1" class="H-textbox H-vertical-align-middle H-vertical-middle H-font-size-14 H-flex-item H-box-sizing-border-box H-border-none H-outline-none H-padding-12" data-rule="n" data-nullmsg="国籍代码不能为空" data-errmsg="国籍代码填写错误"
					placeholder="填写国籍代码" />
				</div>
				<!--证件类型 start-->
				<div class="H-text-list H-flexbox-horizontal  H-theme-background-color-white H-border-vertical-bottom-margin-left-10-after H-vertical-middle H-touch-active"  onclick="IDtype();">
					<div class="H-flex-item H-padding-horizontal-left-10 H-padding-horizontal-right-15 H-font-size-14 H-padding-vertical-both-12">
						证件类型: <span class="H-padding-horizontal-both-12" id="gmfsfzjlx_dm" >请选择证件类型</span>
					</div>
					<span class="H-icon H-padding-horizontal-right-5 H-display-block"> <i class="H-iconfont H-icon-arrow-right H-theme-font-color-ccc H-font-size-14 H-vertical-middle"></i> </span>
				</div>
				<!--证件类型 end-->
				<div class="H-flexbox-horizontal H-border-vertical-bottom-margin-left-10-after">
					<span class="H-vertical-middle H-padding-horizontal-left-10 H-theme-background-color-white H-font-size-14">证件号码：</span>
					<input type="text" name="gmfzjhm" value="410103196405045555" class="H-textbox H-vertical-align-middle H-vertical-middle H-font-size-14 H-flex-item H-box-sizing-border-box H-border-none H-outline-none H-padding-12"
					placeholder="填写证件号码" />
				</div>
				<div class="H-flexbox-horizontal H-border-vertical-bottom-margin-left-10-after">
					<span class="H-vertical-middle H-padding-horizontal-left-10 H-theme-background-color-white H-font-size-14">联系电话：</span>
					<input type="text" name="gmflxdh" value="13101458888" class="H-textbox H-vertical-align-middle H-vertical-middle H-font-size-14 H-flex-item H-box-sizing-border-box H-border-none H-outline-none H-padding-12" data-rule="tm" data-nullmsg="联系电话不能为空" data-errmsg="联系电话填写错误"
					placeholder="填写联系电话" />
				</div>
				<div class="H-flexbox-horizontal H-border-vertical-bottom-margin-left-10-after">
					<span class="H-vertical-middle H-padding-horizontal-left-10 H-theme-background-color-white H-font-size-14">地址：</span>
					<input type="text" name="gmfdz" value="河南省地税局" class="H-textbox H-vertical-align-middle H-vertical-middle H-font-size-14 H-flex-item H-box-sizing-border-box H-border-none H-outline-none H-padding-12" data-rule="*" data-nullmsg="地址不能为空" data-errmsg="地址填写错误"
					placeholder="填写地址" />
				</div>
			</div>
		</form>
		<footer class="H-footer H-padding-10 ">
			<button id="btn" class="H-margin-vertical-top-10 H-position-static H-button H-width-100-percent  H-font-size-15 H-outline-none H-padding-vertical-both-12 H-padding-horizontal-both-20 H-theme-background-color1 H-theme-font-color-white H-theme-border-color1 H-theme-background-color1-click H-theme-font-color1-click ">
				下一步(2/4)
			</button>
		</footer>
		<script type="text/html" id="sale_data">
			<!--纳税人识别号 start-->
			<div class="H-flexbox-horizontal H-border-vertical-bottom-margin-left-10-after">
			<span class="H-vertical-middle H-padding-horizontal-left-10 H-theme-background-color-white H-font-size-16">纳税人识别号：</span>
			<input type="text" value="1515165156" name="gmfnsrsbh" class="H-textbox H-vertical-align-middle H-theme-font-color-666 H-vertical-middle H-text-align-right H-font-size-16 H-flex-item H-box-sizing-border-box H-border-none H-outline-none H-padding-12" data-rule="n" data-nullmsg="纳税人识别号不能为空" data-errmsg="纳税人识别号填写错误"
			placeholder="纳税人识别号" />
			</div>
			<!--纳税人识别号 end-->
			<!--联系电话 start-->
			<!--纳税人名称 start-->
			<div class="H-text-list H-flexbox-horizontal H-theme-background-color-white H-border-vertical-bottom-margin-left-10-after H-vertical-middle H-touch-active">
			<div class="H-flex-item H-padding-horizontal-left-10 H-padding-horizontal-right-15 H-font-size-16 H-padding-vertical-both-12">
			纳税人名称: <span class="H-padding-horizontal-both-12 H-float-right H-theme-font-color-666" id="gmfszjlxmc">{{ d.transferor_name }}</span>
			</div>
			</div>
			<!--纳税人名称 end-->
			<!--证件类型 start-->
			<div class="H-text-list H-flexbox-horizontal H-theme-background-color-white H-border-vertical-bottom-margin-left-10-after H-vertical-middle H-touch-active">
			<div class="H-flex-item H-padding-horizontal-left-10 H-padding-horizontal-right-15 H-font-size-16 H-padding-vertical-both-12">
			证件类型: <span class="H-padding-horizontal-both-12 H-float-right H-theme-font-color-666" id="gmfsfzjlxmc">{{ d.zrf_zjlxnm }}</span>
			</div>
			</div>
			<!--证件类型 end-->
			<!--证件号码 start-->
			<div class="H-text-list H-flexbox-horizontal H-theme-background-color-white H-border-vertical-bottom-margin-left-10-after H-vertical-middle H-touch-active">
			<div class="H-flex-item H-padding-horizontal-left-10 H-padding-horizontal-right-15 H-font-size-16 H-padding-vertical-both-12">
			证件号码: <span class="H-padding-horizontal-both-12 H-float-right H-theme-font-color-666" id="mfzjhm">{{ d.transferor_certnumber }}</span>
			</div>
			</div>
			<!--证件号码 end-->
			<!--联系电话 start-->
			<div class="H-text-list H-flexbox-horizontal H-theme-background-color-white H-border-vertical-bottom-margin-left-10-after H-vertical-middle H-touch-active">
			<div class="H-flex-item H-padding-horizontal-left-10 H-padding-horizontal-right-15 H-font-size-16 H-padding-vertical-both-12">
			联系电话: <span class="H-padding-horizontal-both-12 H-float-right H-theme-font-color-666" id="mflxdh">{{ d.transferor_phone }}</span>
			</div>
			</div>
			<!--联系电话 end-->
			<!--国籍代码 start-->
			<div class="H-text-list H-flexbox-horizontal H-theme-background-color-white H-border-vertical-bottom-margin-left-10-after H-vertical-middle H-touch-active" tapmode onclick="select('mfgjjc','010');">
			<div class="H-flex-item H-padding-horizontal-left-10 H-padding-horizontal-right-15 H-font-size-14 H-padding-vertical-both-12">
			国籍: <span class="H-padding-horizontal-both-12  H-theme-font-color-666 H-float-right" id="mfgjjc">点击选择卖方国籍</span>
			</div>
			<span class="H-icon H-padding-horizontal-right-5 H-display-block"> <i class="H-iconfont H-icon-arrow-right H-theme-font-color-ccc H-font-size-14 H-vertical-middle"></i> </span>
			</div>
			<!--国籍代码 end-->
			<!--地址 start-->
			<div class="H-flexbox-horizontal H-border-vertical-bottom-margin-left-10-after">
			<span class="H-vertical-middle H-padding-horizontal-left-10 H-theme-background-color-white H-font-size-16">地址：</span>
			<input type="text" value="河南省地方税务局" name="mfdz" class="H-textbox H-vertical-align-middle H-theme-font-color-666 H-vertical-middle H-text-align-right H-font-size-16 H-flex-item H-box-sizing-border-box H-border-none H-outline-none H-padding-12" data-rule="*" data-nullmsg="地址不能为空" data-errmsg="地址填写错误"
			placeholder="地址" />
			</div>
			<!--地址 end-->
		</script>
		<script src="../../../../script/H.js" type="text/javascript"></script>
		<script src="../../../../script/zepto.min.js" type="text/javascript"></script>
		<script src="../../../../script/tools/availdate-v1.0.2.js" type="text/javascript"></script>
		<script type="text/javascript">
			var datas = null, assessinfo_id = null, gmfsfzjlx_dm = null, clfxsxxb_id = null;
			H.ready(function() {
				assessinfo_id = api.pageParam.assessinfo_id;
				initPrefs();
				ac.form({
					area : "#forms",
					btn : "#btn", // 触发验证的按钮或者元素，支持标签，id，class，推荐使用id或者class
					singleError : function(e, msg) {
						// 自定义弹窗格式###############
						alert(msg);
					},
					endSuccess : function(data) {
						var value = {
							"gmfsfzjlx_dm" : gmfsfzjlx_dm,
							"user_id" : userinfo[0].user_id,
							"uuid" : userinfo[0].uuid
						};
						datas = data;
						$.extend(datas, value);
						console.log('datas===' + JSON.stringify(datas) + 'assessinfo_id====' + JSON.stringify(assessinfo_id));
						_ajax();
						//						alert(JSON.stringify(datas));
					}
				});
			});
			//获取room偏好值
		//获取偏好值及渲染数据
			function InitPref() {
				H.getUserPref(function() {
					H.getPrefs(function(ret, err) {
						if (ret && ret.value) {
							clfxsxxb_id = eval('(' + ret.value + ')');
							console.log('clfxsxxb_id' + JSON.stringify(clfxsxxb_id));
							var tpl = document.getElementById('sale_data').innerHTML;
							//方式一：异步渲染（推荐）
							laytpl(tpl).render(clfxsxxb_id.data, function(render) {
								document.getElementById('sale_html').innerHTML = render;
							});
							$("button").text('下一步(2/4)');
						} else {
							H.ajax(function(ret, err) {
								results(ret, function() {
									var tpl = document.getElementById('sale_data').innerHTML;
									//方式一：异步渲染（推荐）
									laytpl(tpl).render(ret.data, function(render) {
										api.hideProgress();
										document.getElementById('sale_html').innerHTML = render;
										api.setPrefs({
											key : 'sale' + assessinfo_id,
											value : JSON.stringify(result)
										});
									});
									console.log('sale======' + JSON.stringify(ret));
								});
							}, 'appSaleRecordAdd&funid=wbjh_clfxsxxb&assessinfo_id=' + assessinfo_id, 'post', {
								values : {
									"user_id" : userinfo[0].user_id,
									"uuid" : userinfo[0].uuid
								}
							});
							$("button").text('新增代开发票申请');
						}
					}, 'sale' + assessinfo_id);
				});
			}
			//返回结果处理
			function results(ret, callback) {
				api.hideProgress();
				if (ret.success) {
					result = ret;
					if ( typeof callback == "function") {
						callback();
					}
					api.execScript({
						name : 'sale_header',
						script : 'buildInfo();'
					});
				} else {
					H.toast(ret.message);
				}
			}

			//交易时间选择器
			function timePicker() {
				var date = new Date();
				var seperator1 = "-";
				var year = date.getFullYear();
				var month = date.getMonth() + 1;
				var strDate = date.getDate();
				if (month >= 1 && month <= 9) {
					month = "0" + month;
				}
				if (strDate >= 0 && strDate <= 9) {
					strDate = "0" + strDate;
				}
				var currentdate = year + seperator1 + month + seperator1 + strDate;
				api.openPicker({
					type : 'date',
					date : "'" + currentdate + "'"
				}, function(ret, err) {
					if (ret) {
						$("#times").text(ret.year + '年' + ret.month + '月' + ret.day + '日');
						dates = ret.year + '-' + ret.month + '-' + ret.day;
						//						alert(JSON.stringify(ret));
					} else {
						H.toast('选择时间错误');
					}
				});
			}

			function _ajax() {
				//1.4、已经登录
				//更新存量房信息
				if (gmfsfzjlx_dm) {
					api.showProgress();
					H.ajax(function(ret, err) {
						results(ret);
					}, 'appSaleRecordUpdate&funid=wbjh_clfxsxxb&fwuuid=' + clfxsxxb_id.data.fwuuid, 'post', {
						values : datas
					});
				} else {
					H.toast('您还有未选择的选项');
				}
			}

			//受让方证件类型选择器
			function IDtype() {
				H.actionSheet(function(ret, err) {
					gmfsfzjlx_dm = ret.buttonIndex;
					switch (gmfsfzjlx_dm) {
						case 1:
							$("#gmfsfzjlx_dm").html("身份证");
							$("input[name=gmfzjhm]").attr({
								'data-rule' : 'idcard',
								'data-nullmsg' : '身份证号不能为空',
								'data-errmsg' : '身份证号填写错误'
							});
							break;
						case 2:
							$("#gmfsfzjlx_dm").html("纳税人识别号");
							$("input[name=gmfzjhm]").attr({
								'data-rule' : 'n',
								'data-nullmsg' : '纳税人识别号不能为空',
								'data-errmsg' : '纳税人识别号填写错误'
							});
							break;
						case 3:
							$("#gmfsfzjlx_dm").html("组织机构代码");
							$("input[name=gmfzjhm]").attr({
								'data-rule' : 'n',
								'data-nullmsg' : '组织机构代码不能为空',
								'data-errmsg' : '组织机构代码填写错误'
							});
							break;
					};
				}, '请选择证件类型', ['身份证', '纳税人识别号', '组织机构代码']);
			}
		</script>
	</body>
</html>