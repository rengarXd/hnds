<!doctype html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
		<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
		<title>Hui</title>
		<link href="../../../css/Hui.css" rel="stylesheet" type="text/css" />
		<style type="text/css">
			.H_header_bg {
				background: #09a4de
			}
		</style>
	</head>

	<body>
		<div class="H-channel-title H-flexbox-horizontal H-theme-background-color-white H-vertical-middle H-border-vertical-bottom-after">
			<div class="H-channel-line H-theme-background-color-black H-padding-vertical-top-15 H-padding-horizontal-left-3  H-margin-horizontal-left-10"></div>
			<div class="H-channel-text H-theme-font-color-black H-flex-item H-font-size-18 H-theme-font-color-black H-padding-10 H-margin-horizontal-right-10 H-text-show-row-1">
				转让双方信息
			</div>
		</div>
		<form id="forms">
			<div class="H-border-vertical-both-after">
				<div class="H-flexbox-horizontal H-border-vertical-bottom-margin-left-10-after">
					<span class="H-vertical-middle H-padding-horizontal-left-10 H-theme-background-color-white H-font-size-14">转让方纳税人：</span>
					<input type="text" name="transferor_name" class="H-textbox H-vertical-align-middle H-vertical-middle H-font-size-14 H-flex-item H-box-sizing-border-box H-border-none H-outline-none H-padding-12" data-rule="*" data-nullmsg="信息不能为空" data-errmsg="填写信息不能为空"
						placeholder="填写信息不能为空" />
				</div>
				<div class="H-text-list H-flexbox-horizontal  H-theme-background-color-white H-border-vertical-bottom-margin-left-10-after H-vertical-middle H-touch-active" onclick="select();">
					<div class="H-flex-item H-padding-horizontal-left-10 H-padding-horizontal-right-15 H-font-size-14 H-padding-vertical-both-12">
						请选择证件类型: <span class="H-padding-horizontal-both-12" id="type_option"></span>
					</div>
					<span class="H-icon H-padding-horizontal-right-5 H-display-block"> <i class="H-iconfont H-icon-arrow-right H-theme-font-color-ccc H-font-size-14 H-vertical-middle"></i> </span>
				</div>
				<div class="H-flexbox-horizontal">
					<span class="H-vertical-middle H-padding-horizontal-left-10 H-theme-background-color-white H-font-size-14">转让方证件号码：</span>
					<input type="text" name="transferor_certnumber" value="4101032656566111552" class="H-textbox H-vertical-align-middle H-vertical-middle H-font-size-14 H-flex-item H-box-sizing-border-box H-border-none H-outline-none H-padding-12" data-rule="*" data-nullmsg="信息不能为空"
						data-errmsg="填写信息不能为空" placeholder="填写信息不能为空" />
				</div>
			</div>
		</form>
		<div class="H-padding-vertical-bottom-10"></div>
		<button id="btn" class="H-button H-width-100-percent H-font-size-18 H-outline-none H-theme-background-color-transparent H-padding-12 H-padding-horizontal-both-20 H-theme-font-color1 H-theme-border-color1 H-theme-border-color1-click H-theme-background-color1-click H-theme-font-color1-click">
			新&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;增
		</button>
		<script src="../../../script/H.js" type="text/javascript"></script>
		<script src="../../../script/zepto.min.js" type="text/javascript"></script>
		<script src="../../../script/tools/availdate-v1.0.2.js" type="text/javascript"></script>
		<script type="text/javascript">
		var assessinfo = null;
			Zepto(function($) {});
			H.ready(function() {
				H.getPrefs(function(ret, err) {
					if (ret && ret.value) {
						assessinfo = eval('(' + ret.value + ')');
						
					} else {
						
					}
				}, 'rooms');
				ac.form({
					area: "#forms",
					btn: "#btn", // 触发验证的按钮或者元素，支持标签，id，class，推荐使用id或者class
					singleError: function(e, msg) {
						// 自定义弹窗格式###############
						alert(msg);
					},
					//					singleSuccess : function(e, msg) {
					//						// 验证单个成功之后提示信息
					//						alert(JSON.stringify(e));
					//						alert(JSON.stringify(msg));
					//					},
					endSuccess: function(data) {
						datas = data;
						post_data();
//						alert(JSON.stringify(data));
					}
				});
			});
			
			function select() {
				H.actionSheet(function(ret, err) {
					type_option = ret.buttonIndex;
					switch (type_option) {
						case 1:
							$("#type_option").html("身份证");
							break;
						case 2:
							$("#type_option").html("纳税人识别号");
							break;
						case 3:
							$("#type_option").html("组织机构代码");
							break;
					}
					console.log(JSON.stringify(ret));
				}, '请选择证件类型', ['身份证', '纳税人识别号', '组织机构代码']);
			}

			function get_PREFS() {
				//1.4、已经登录
				if (assessinfo) {
					//更新存量房信息
					H.ajax(function(ret, err) {
						api.hideProgress();
						if (ret && ret.success) {
							H.toast(ret.message);
						} else {
							H.toast(ret.message);
						}
					}, 'appHouseAssessAdd&funid=houses_assessinfo&user_id=' + userinfo[0].userinfo_id + '&uuid=' + userinfo[0].uuid + '&assessinfo_id=' + assessinfo.data.assessinfo_id, 'post', {
						values: datas
					});
				} else {
					console.log($("input[name='transferor_certnumber']").val());
					//新增存量房信息
					H.ajax(function(ret, err) {
						api.hideProgress();
						if (ret && ret.success) {
//							var result = ret;
							H.toast(ret.message);
							H.setPrefs(function(ret, err) {
								H.toast(ret.message);
							}, 'rooms', JSON.stringify(ret));
						} else {
							H.toast(err.message);
						}
					}, 'appHouseAssessAdd&funid=houses_assessinfo&user_id=' + userinfo[0].userinfo_id + '&uuid=' + userinfo[0].uuid, 'post', {
						values: {
							"transferor_certype": type_option,
							"transferor_certnumber": $("input[name='transferor_certnumber']").val()
						}
						//						$("#forms").serialize()
					});
				}
			}

			function post_data() {
				H.getUserPref(function() {
				    console.log(JSON.stringify(userinfo));
					H.removePrefs(function(ret, err) {
						get_PREFS();
					}, 'rooms');
				});
			}
		</script>
	</body>

</html>